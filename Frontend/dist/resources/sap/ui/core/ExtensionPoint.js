/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/ui/core/mvc/View","sap/ui/core/Component"],function(e,n,i,t){"use strict";sap.ui.extensionpoint=function(n,i,t,a,r){e.warning("Do not use deprecated factory function 'sap.ui.extensionpoint'. Use 'sap.ui.core.ExtensionPoint.load' instead","sap.ui.extensionpoint",null,function(){return{type:"sap.ui.extensionpoint",name:i}});return o._factory(n,i,t,a,r)};var o=sap.ui.extensionpoint;o._factory=function(n,a,r,s,u,f){var c,g,l,d,p;if(n){if(n.isA("sap.ui.core.mvc.View")){d=n.sViewName;g=n}else if(n.isA("sap.ui.core.Fragment")){d=n.getFragmentName();g=n._oContainingView}if(!sap.ui.getCore().getConfiguration().getDisableCustomizing()){p=t.getOwnerComponentFor(n);if(p){if(p.getExtensionComponent){p=p.getExtensionComponent();if(!p){throw new Error("getExtensionComponent() must return an instance.")}}c=p._getManifestEntry("/sap.ui5/extends/extensions/sap.ui.viewExtensions/"+d+"/"+a,true)}}}if(c){if(c.className){e.info("Customizing: View extension found for extension point '"+a+"' in View '"+g.sViewName+"': "+c.className+": "+(c.viewName||c.fragmentName));var m=g&&c.id?g.createId(c.id):c.id;var w={async:f,id:m,type:c.type};if(f&&g._sProcessingMode){w.processingMode=g._sProcessingMode}if(c.className==="sap.ui.core.Fragment"){var x=sap.ui.require("sap.ui.core.Fragment");w.fragmentName=c.fragmentName;w.containingView=g;if(f){if(x){l=x.load(w)}else{l=new Promise(function(e,n){sap.ui.require(["sap/ui/core/Fragment"],function(n){e(n.load(w))},n)})}}else{x=x||sap.ui.requireSync("sap/ui/core/Fragment");var v=new x(w);l=Array.isArray(v)?v:[v]}}else if(c.className==="sap.ui.core.mvc.View"){w.viewName=c.viewName;var N=i._create(w);if(f){l=N.loaded()}else{l=[N]}}else{e.warning("Customizing: Unknown extension className configured (and ignored) in Component.js for extension point '"+a+"' in View '"+g.sViewName+"': "+c.className)}}else{e.warning("Customizing: no extension className configured in Component.js for extension point '"+a+"' in View '"+g.sViewName+"': "+c.className)}}else if(o._fnExtensionProvider){var y=o._fnExtensionProvider(g);var C;if(g.isA("sap.ui.core.Fragment")){C=g._sExplicitId;var _=g.getController();g=_&&typeof _.isA==="function"&&_.isA("sap.ui.core.mvc.Controller")&&_.getView();if(g){C=g.getLocalId(C)||C}}if(y){if(!g){e.warning("View instance could not be passed to ExtensionPoint Provider for extension point '"+a+"' "+"in fragment '"+C+"'.")}return[{providerClass:y,view:g,fragmentId:C,name:a,createDefault:r,targetControl:undefined,aggregationName:undefined,index:undefined,ready:function(e){var n=this._nextSibling;while(n!=null){n.index+=e.length;n=n._nextSibling}},_isExtensionPoint:true,_nextSibling:null}]}}if(!l&&typeof r==="function"){l=r()}var E=function(n){if(n&&!Array.isArray(n)){n=[n]}if(n&&s){var i=s.getMetadata().getAggregation(u);if(i){for(var t=0,o=n.length;t<o;t++){s[i._sMutator](n[t])}}else{e.error("Creating extension point failed - Tried to add extension point with name "+a+" to an aggregation of "+s.getId()+" in view "+g.sViewName+", but sAggregationName was not provided correctly and I could not find a default aggregation")}}return n||[]};if(l&&typeof l.then==="function"){return l.then(E)}else{return E(l)}};o.registerExtensionProvider=function(n){if(n==null){delete o._fnExtensionProvider}else if(typeof n=="function"){o._fnExtensionProvider=n}else{e.error("ExtensionPoint provider must be a function!")}};o.load=function(e){return Promise.resolve(o._factory(e.container,e.name,e.createDefaultContent,null,null,!!e.async))};return o});
//# sourceMappingURL=ExtensionPoint.js.map