/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["./library","sap/ui/core/Core","sap/ui/core/Control","sap/ui/core/library","sap/ui/Device","sap/m/Link","sap/m/Text","sap/m/Button","sap/m/ResponsivePopover","sap/m/HyphenationSupport","./ExpandableTextRenderer"],function(e,t,r,a,i,n,o,p,s,l,d){"use strict";var g=t.getLibraryResourceBundle("sap.m");var u=g.getText("EXPANDABLE_TEXT_SHOW_MORE");var h=g.getText("EXPANDABLE_TEXT_SHOW_LESS");var c=g.getText("MSGBOX_CLOSE");var x=a.TextAlign;var f=a.TextDirection;var y=a.aria.HasPopup;var T=e.WrappingType;var m=e.PlacementType;var v=e.ExpandableTextOverflowMode;var b=e.EmptyIndicatorMode;function _(e){return e.replace(/ {2,}/g," ").replace(/\t{2,}/g," ")}var A=r.extend("sap.m.ExpandableText",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.m.IHyphenation"],library:"sap.m",properties:{text:{type:"string",defaultValue:"",bindable:"bindable"},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:f.Inherit},wrappingType:{type:"sap.m.WrappingType",group:"Appearance",defaultValue:T.Normal},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:x.Begin},renderWhitespace:{type:"boolean",group:"Appearance",defaultValue:false},overflowMode:{type:"sap.m.ExpandableTextOverflowMode",group:"Appearance",defaultValue:v.InPlace},maxCharacters:{type:"int",group:"Appearance",defaultValue:100},expanded:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"},emptyIndicatorMode:{type:"sap.m.EmptyIndicatorMode",group:"Appearance",defaultValue:b.Off}},aggregations:{_showMoreLink:{type:"sap.m.Link",multiple:false,visibility:"hidden"}},designtime:"sap/m/designtime/ExpandableText.designtime"}});A.prototype.getText=function(e){var t=this.getProperty("text");if(e){return t.replace(/\r\n|\n\r|\r/g,"\n")}return t};A.prototype.getTextDomRef=function(){if(!this.getVisible()){return null}return this.getDomRef("string")};A.prototype._isExpandable=function(){var e=this.getText();if(!this.getRenderWhitespace()){e=_(e)}return e.length>this._getMaxCharacters()+u.length};A.prototype._getMaxCharacters=function(){return Math.max(0,this.getMaxCharacters())};A.prototype._getDisplayedText=function(){var e=this.getText(true);if(this.getProperty("expanded")||!this._isExpandable()){return e}if(!this.getRenderWhitespace()){e=_(e)}return e.substring(0,this._getMaxCharacters())};A.prototype._getShowMoreLink=function(){var e=this.getAggregation("_showMoreLink");if(!e){e=new n(this.getId()+"-showMoreLink",{text:this.getProperty("expanded")?h:u,press:function(t){var r,a,n;if(this.getOverflowMode()===v.InPlace){a=!this.getProperty("expanded");e.setText(a?h:u);this.setProperty("expanded",a)}else{r=new o({text:this.getText(),textDirection:this.getTextDirection(),wrappingType:this.getWrappingType(),textAlign:this.getTextAlign(),renderWhitespace:this.getRenderWhitespace()}).addStyleClass("sapUiSmallMargin").addStyleClass("sapMExTextPopover");n=this._oPopover;if(n&&n.isOpen()){n.close();return}if(!n){n=this._oPopover=new s({showHeader:false,placement:m.HorizontalPreferredRight,beforeClose:this._onPopoverBeforeClose.bind(this)});if(i.system.phone){n.setEndButton(new p({text:c,press:function(){n.close()}}))}this.addDependent(n)}e.setText(h);e.rerender();n.removeAllAriaLabelledBy();n.destroyContent();n.addAriaLabelledBy(r);n.addContent(r);n.openBy(t.getSource())}}.bind(this)});this.setAggregation("_showMoreLink",e,true)}e.setAriaHasPopup(this.getOverflowMode()===v.InPlace?y.None:y.Dialog);return e};A.prototype._onPopoverBeforeClose=function(){this._getShowMoreLink().setText(u)};A.prototype.exit=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};A.prototype.getAccessibilityInfo=function(){return{description:this.getText()}};A.prototype.getTextsToBeHyphenated=function(){return{main:this._getDisplayedText(true)}};A.prototype.getDomRefsForHyphenatedTexts=function(){return{main:this.getTextDomRef()}};l.mixInto(A.prototype);return A});
//# sourceMappingURL=ExpandableText.js.map