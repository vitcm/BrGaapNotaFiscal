/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Control","./Popup","./library","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/control"],function(t,e,o,i,jQuery){"use strict";var s=o.OpenState;var r=t.extend("sap.ui.core.TooltipBase",{metadata:{abstract:true,library:"sap.ui.core",properties:{text:{type:"string",group:"Misc",defaultValue:""},openDuration:{type:"int",group:"Behavior",defaultValue:200},closeDuration:{type:"int",group:"Behavior",defaultValue:200},myPosition:{type:"sap.ui.core.Dock",group:"Behavior",defaultValue:"begin top"},atPosition:{type:"sap.ui.core.Dock",group:"Behavior",defaultValue:"begin bottom"},offset:{type:"string",group:"Behavior",defaultValue:"10 3"},collision:{type:"sap.ui.core.Collision",group:"Behavior",defaultValue:"flip"},openDelay:{type:"int",group:"Misc",defaultValue:500},closeDelay:{type:"int",group:"Misc",defaultValue:100}},events:{closed:{}}},renderer:null});r.prototype._getPopup=function(){var t=new e;t.setShadow(true);r.prototype._getPopup=function(){return t};return t};r.prototype.onfocusin=function(t){var e=jQuery(t.target).control(0);if(e!=null){var o=e.getFocusDomRef();this.sStoredTooltip=null;if(o.title&&o.title!=""){this.sStoredTooltip=o.title;o.title=""}var i=this._getPopup();if(!(i.isOpen()&&i.getContent()==this)){sap.ui.getCore().getRenderManager().render(this,sap.ui.getCore().getStaticAreaRef(),true)}var s=o.getAttribute("aria-describedby");var r=this.getId()+"-title "+this.getId()+"-txt";if(s==null||s==""){o.setAttribute("aria-describedby",r)}else if(s.indexOf(r)==-1){o.setAttribute("aria-describedby",s+" "+r)}}};r.prototype.onfocusout=function(t){var e=jQuery(t.target).control(0);if(e!=null){var o=e.getFocusDomRef();if(this.sStoredTooltip){o.title=this.sStoredTooltip}var i=o.getAttribute("aria-describedby");var s=this.getId()+"-title "+this.getId()+"-txt";if(i&&i.indexOf(s)>=0){if(i.trim()==s){o.removeAttribute("aria-describedby")}else{i=i.replace(s,"");o.setAttribute("aria-describedby",i)}}}if(r.sOpenTimeout){clearTimeout(r.sOpenTimeout);r.sOpenTimeout=undefined}this.sCloseNowTimeout=setTimeout(this["closePopup"].bind(this),this.getCloseDelay())};r.prototype.isStandardTooltip=function(t){return typeof t==="string"&&!!t.trim()};r.prototype.onmouseover=function(t){var e=jQuery(t.target).control(0),o=jQuery(t.currentTarget).control(0),i=jQuery(t.relatedTarget).control(0);if(!e){return}if(e===this){if(this.sCloseNowTimeout){clearTimeout(this.sCloseNowTimeout);this.sCloseNowTimeout=null}t.stopPropagation();t.preventDefault();return}if(o===e||!this.isStandardTooltip(e.getTooltip())){if(this.sCloseNowTimeout){clearTimeout(this.sCloseNowTimeout);this.sCloseNowTimeout=null;t.stopPropagation();t.preventDefault()}}if(i){if(i.getParent()){if(i.getParent()===o&&o===e){var s=i.getTooltip();if(!this.isStandardTooltip(s)&&(!s||!(s instanceof r))){if(this.sCloseNowTimeout){clearTimeout(this.sCloseNowTimeout);this.sCloseNowTimeout=null;t.stopPropagation();t.preventDefault()}}}}}if(this._currentControl===e||!this.isStandardTooltip(e.getTooltip())){this.removeStandardTooltips();if(r.sOpenTimeout){clearTimeout(r.sOpenTimeout)}r.sOpenTimeout=setTimeout(this["openPopup"].bind(this,this._currentControl),this.getOpenDelay());t.stopPropagation();t.preventDefault()}};r.prototype.onmouseout=function(t){if(r.sOpenTimeout){clearTimeout(r.sOpenTimeout);r.sOpenTimeout=undefined}if(!this.sCloseNowTimeout){this.sCloseNowTimeout=setTimeout(this["closePopup"].bind(this),this.getCloseDelay())}this.restoreStandardTooltips();t.stopPropagation();t.preventDefault()};r.prototype.closePopup=function(){var t=this._getPopup();if(this.sCloseNowTimeout){clearTimeout(this.sCloseNowTimeout)}this.sCloseNowTimeout=undefined;t.attachClosed(this.handleClosed,this);t.close();this.restoreStandardTooltips()};r.prototype.handleClosed=function(){this._getPopup().detachClosed(this.handleClosed,this);this.fireClosed()};r.prototype.openPopup=function(t){if(!this.getVisible()){return}if(t.getTooltip()!=null){if(this.sCloseNowTimeout){clearTimeout(this.sCloseNowTimeout);this.sCloseNowTimeout=null;return}var e=this._getPopup();if(e.isOpen()&&e.getContent()==this){return}var o=t.getDomRef();e.setContent(this);e.setPosition(this.getMyPosition(),this.getAtPosition(),o,this.getOffset(),this.getCollision());e.setDurations(this.getOpenDuration(),this.getCloseDuration());e.open();this.removeStandardTooltips()}};r.prototype.removeStandardTooltips=function(){var t=this._currentControl.getDomRef();if(!this.aStoredTooltips){this.aStoredTooltips=[]}else{return}var e="";while(t&&!(t===document)){e=t.title;if(e){this.aStoredTooltips.push({domref:t,tooltip:e});t.title=""}t=t.parentNode}if(this._currentControl.getTooltipDomRefs){var o=this._currentControl.getTooltipDomRefs();for(var i=0;i<o.length;i++){t=o[i];if(t){e=t.title;if(e){this.aStoredTooltips.push({domref:t,tooltip:e});t.title=""}}}}};r.prototype.restoreStandardTooltips=function(){var t=this._getPopup();var e=t.getOpenState();if(e===s.OPEN||e===s.OPENING){return}if(r.sOpenTimeout){return}if(this.aStoredTooltips){for(var o=0;o<this.aStoredTooltips.length;o++){var i=this.aStoredTooltips[o].domref;i.title=this.aStoredTooltips[o].tooltip}}this.aStoredTooltips=null};r.prototype.setParent=function(e,o){var i=this._getPopup();if(i&&i.isOpen()){this.closePopup()}t.prototype.setParent.apply(this,arguments)};r.prototype.onkeydown=function(t){if(t.ctrlKey&&t.which==i.I){var e=jQuery(t.target).control(0);if(e!=null){if(this._currentControl===e||!this.isStandardTooltip(e.getTooltip())){this.removeStandardTooltips();this.openPopup(this._currentControl);t.preventDefault();t.stopPropagation()}}}else if(t.which==i.ESCAPE){if(r.sOpenTimeout){clearTimeout(r.sOpenTimeout);r.sOpenTimeout=undefined}var o=this.oPopup&&this.oPopup.isOpen();this.closePopup();if(o){t.preventDefault();t.stopPropagation()}}};r.prototype._closeOrPreventOpen=function(){var t=this._getPopup();if(t.isOpen()){this.closePopup()}else if(r.sOpenTimeout){clearTimeout(r.sOpenTimeout);r.sOpenTimeout=undefined}};return r});
//# sourceMappingURL=TooltipBase.js.map