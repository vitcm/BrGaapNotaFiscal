/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/base/BindingParser","sap/ui/core/Control","sap/ui/core/RenderManager","sap/base/util/ObjectPath","sap/base/Log","sap/base/assert","sap/ui/thirdparty/jquery"],function(e,t,r,a,n,i,o,jQuery){"use strict";var s=e.extend("sap.ui.core.tmpl.Template",{constructor:function(t,r){e.apply(this,arguments)},metadata:{stereotype:"template",abstract:true,library:"sap.ui.core",properties:{content:{type:"string",group:"Data",defaultValue:null}},publicMethods:["declareControl","createControl","placeAt","createMetadata","createRenderer"]}});var p={};s.prototype.register=function(){var e=this.getId(),t=p[e],r;if(t&&this!==t){r="adding template with duplicate id '"+e+"'";i.error(r);throw new Error("Error: "+r)}p[e]=this};s.prototype.deregister=function(){delete p[this.getId()]};s.byId=function(e){return p[e]};s.prototype.getInterface=function(){return this};s._mSupportedTypes={};s.registerType=function(e,t){s._mSupportedTypes[e]=t};s.unregisterType=function(e){delete s._mSupportedTypes[e]};s.parsePath=function(e){var t,r=e.indexOf(">");if(r>0){t=e.substr(0,r);e=e.substr(r+1)}return{path:e,model:t}};s.prototype.init=function(a,n){if(this.getMetadata().getName()==="sap.ui.core.tmpl.Template"){throw new Error("The class 'sap.ui.core.tmpl.Template' is abstract and must not be instantiated!")}if(e.bindingParser===t.complexParser){s.prototype.extractBindingInfo=function(a,n,i){e.bindingParser=t.simpleParser;var o=r.prototype.extractBindingInfo.apply(this,arguments);e.bindingParser=t.complexParser;return o}}};s.prototype.declareControl=function(e){o(!!e,"A fully qualified name must be specified!");if(e){var t=this.createMetadata(),r=this.createRenderer(),a=this;var i=sap.ui.requireSync("sap/ui/core/tmpl/TemplateControl");i.extend(e,{metadata:t,init:function(){i.prototype.init.apply(this,arguments);this.setTemplate(a)},renderer:{renderTemplate:r,hasControlData:t._hasControlData}});return n.get(e||"")}};s.prototype.createControl=function(e,t,r){var a=sap.ui.requireSync("sap/ui/core/tmpl/TemplateControl");var n=new a({id:e,template:this,context:t});n.setTemplateRenderer(this.createRenderer(r));return n};s.prototype.placeAt=function(e,t,n,i){if(typeof t==="string"||typeof t==="number"){n=t;t=undefined}var o;if(!(e instanceof r)&&i){var s=typeof e==="string"?jQuery(document.getElementById(e)):jQuery(e);if(s.length>0){o=s.attr("id");e=s.get(0);var p=s.attr("data-context");t=t||p&&JSON.parse(p);a.markInlineTemplate(s)}}var c=this.createControl(o,t);c.placeAt(e,n);return c};s.prototype.createMetadata=function(){i.error("The function createMetadata is an abstract function which needs to be implemented by subclasses.")};s.prototype.createRenderer=function(){i.error("The function createRenderer is an abstract function which needs to be implemented by subclasses.")};sap.ui.template=function(e){var t=function(e){i.warning("The usage of Template Views is deprecated since 1.56. Please make use of the asynchronous create functions of the different view classes, e.g. XMLView.create()","Deprecation",null,function(){return{type:"sap.ui.template",name:e}})};if(!e){var r=[];jQuery.each(s._mSupportedTypes,function(e,t){jQuery("script[type='"+e+"'], [data-type='"+e+"']").each(function(a,n){r.push(sap.ui.template({id:n.id,domref:n,type:e,_class:t}))})});return r}else{if(typeof e==="string"){return sap.ui.template({id:e})}else if(e&&e.tagName&&e.nodeName&&e.ownerDocument&&e.nodeType===1){return sap.ui.template({id:e.id,domref:e})}e=jQuery.extend({type:s.DEFAULT_TEMPLATE},e);t(e.id);var a,o,p,c,l=false,u=typeof e.src==="string",d=false;if(u){jQuery.ajax({url:e.src,dataType:"text",async:false,success:function(t){a=e.id;o=e.type;p=e.control;c=t;var r=/^<!--\sUI5:Template\stype=([a-z\/\-]*)\s(?:controller=([A-Za-z.]*)\s)?-->/,n=c.match(r);if(n){o=n[1];if(n.length==3){l=n[2]}c=c.substr(n[0].length)}},error:function(){throw new Error("The template could not be loaded from "+e.src+"!")}})}else{var f=e.domref||(e.id?window.document.getElementById(e.id):null),m=jQuery(f);d=false;a=e.id||f&&f.id;o=m.attr("type")||e.type;p=m.attr("data-control")||e.control;if(a){var h=sap.ui.getCore().getTemplate(a);if(!h instanceof s){throw new Error('Object for id "'+a+'" is no sap.ui.core.tmpl.Template!')}else{if(h){return h}}}if(m.length===0){throw new Error('DOM element for the Template with the id "'+a+'" not found!')}c=m.html();var y=f.tagName.toLowerCase();if(y!=="script"){d=m.parents("body").length===1}}var g=e._class;if(!g){g=s._mSupportedTypes[o];if(!g){throw new Error('The type "'+o+'" is not supported.')}}var T=sap.ui.requireSync(g.replace(/\./g,"/"));T=T||n.get(g||"");var b=new T({id:a,content:c});if(p){b.declareControl(p)}if(l){b._sControllerName=l}if(d){b.placeAt(a,e.context,undefined,true)}return b}};s.DEFAULT_TEMPLATE="text/x-handlebars-template";s.registerType(s.DEFAULT_TEMPLATE,"sap.ui.core.tmpl.HandlebarsTemplate");return s});
//# sourceMappingURL=Template.js.map